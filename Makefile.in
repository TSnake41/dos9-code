# Overall Dos9 suite Makefile, The Dos9 Project (c) Darkbatcher
# 2010-2013
#
# This is free software: you can redistribute it and/or modify it under the
# terms of the GNU General Public License as published by the Free Software 
# Foundation, either version 3 of the License, or (at your option) any later
# version.
#

DOS9_COMPONENTS=libw libDos9 libinteval libmatheval-dos9 dos9 tea dump po scripts
DOS9_CLEAN=libDos9 libinteval libmatheval-dos9 dos9 tea dump libw
BUILD_TREE=bin${arch} bin${arch}/cmd bin${arch}/share bin${arch}/share \
	   bin${arch}/share/man include lib 

all:
	$(MAKE) build-tree
	$(MAKE) bin
	$(MAKE) doc

# define a list of components to be build

bin:
	for i in $(DOS9_COMPONENTS); do $(MAKE) -e -C $$i ; done;

doc:
	cp -r ./man ./bin${arch}/share/
	
build-tree:
	for i in $(BUILD_TREE); do mkdir -p $$i ; chmod 777 $$i; done;

po-merge:
	$(MAKE) -e -C po po-merge
	
.PHONY: clean bin doc


clean:
	for i in $(DOS9_CLEAN); do $(MAKE) -e -C $$i clean ; done;
	for i in bin lib include; do rm -f -r $$i ; done;
