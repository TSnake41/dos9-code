# libDos9, The Dos9 Project - Copyright © 2010-2014 Darkbatcher
#
# This is free software: you can redistribute it and/or modify it under the
# terms of the GNU General Public License as published by the Free Software 
# Foundation, either version 3 of the License, or (at your option) any later
# version.
#
# Please report bugs, and mistakes at : <darkbatcher at dos9 dot org>
#

TARGET=../lib/libDos9.a

INCLUDE_FILE=../include/libDos9.h
ORIGIN_FILE=./libDos9-export.h

#the list of the sources
SRC=./cmdlist/Dos9_CmdList.c ./console/linux/Dos9_Console.c \
    ./console/win/Dos9_Console.c ./dir/Dos9_Attr.c ./dir/Dos9_Dir.c \
    ./enc/Dos9_Enc.c ./estr/Dos9_Estr.c stack/Dos9_Stack.c \
    ./thread/Dos9_Thread.c ./file/Dos9_StdFile.c \
    ./file/Dos9_Win32File.c ./init/Dos9_Init.c ./cmdlib/Dos9_String.c 
	
CFLAGS=@CFLAGS@
CC=@CC@	
OBJ=$(SRC:.c=.o)

all: $(TARGET) $(INCLUDE_FILE)

$(INCLUDE_FILE): $(ORIGIN_FILE)
	cp $(ORIGIN_FILE) $(INCLUDE_FILE)

# build the main lib
$(TARGET): $(OBJ)
	ar -r -s $(TARGET) $(OBJ) 

clean:
	for i in $(SRC:.c=.o); do rm -f $$i ; done;

.PHONY: clean

.SUFFIXES: .o

.c.o:
	$(CC) $(CFLAGS) -o $@ -c $<


